<html>

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>TalkChat V2</title>
    
        <style>
        
        </style>

    </head>

    <body>
        
        <div id="displayArea">

            <div id="chatArea">
                <ul id="messages"></ul>
            </div>

            <form id="form">
                <input placeholder='type here...' id="chatInput" autocomplete="off" />
                <button>Send</button>
            </form>

            <form id="userForm">
                <input id="author" type="text" placeholder="Type your nickname">
                <button>Apply</button>
            </form>
        </div>

        <script src="/socket.io/socket.io.js"></script>
        <script>

            var socket = io()

            var form = document.getElementById('form')

            form.addEventListener('submit', (e) => {
                e.preventDefault()

                var author = document.getElementById('author').value
                var messageText = document.getElementById('chatInput').value

                if(author && messageText){

                    var messageObjeto = {
                        nick: author,
                        message: messageText
                    }
                    socket.emit('messageEvent', messageObjeto)
                    document.getElementById('chatInput').value=''                    
                }
            })

            socket.on("messageEvent", (msg) => {
                var item = document.createElement('div')
                var nickItem = document.createElement('strong')
                var messageItem = document.createElement('p')
                nickItem.innerHTML = msg.nick
                messageItem.innerHTML = msg.message
                item.append(nickItem, messageItem)
                messages.append(item)
            })

        </script>

    </body>

</html>